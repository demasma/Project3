duke.eth$Location <- rep("duke", len.xplant)
mcv.eth$Location <- rep("mcv", len.xplant)
r11.eth$Location <- rep("r11", len.xplant)
eth <- merge(uva.eth, duke.eth, all.x=TRUE, all.y=TRUE)
eth <- merge(eth, mcv.eth, all.x=TRUE, all.y=TRUE)
eth <- merge(eth, r11.eth, all.x=TRUE, all.y=TRUE)
eth$Location <- factor(eth$Location)
setwd("~/Google Drive/UVaGrad/6021/RCode/")
# source("TSbootfunctions.R")
# source("SPM_Panel.R")
# source("Transplant.plots.R")
# source("DemographicFunctions.R")
# source("DemographicFunctions-1.R")
r.code.files <- c("TSbootfunctions.R", "SPM_Panel-1.R", "Transplant.plots.R",
"DemographicFunctions.R", "DemographicFunctions-1.R")
for (i in 1:length(r.code.files)) {
source(r.code.files[i])
}
setwd("~/Google Drive/UVaGrad/6021/Project3/")
uva.xplant <- uva.xplant[-26, c("Year", "Liver", "Liver_DD", "Liver_LD","Kidney", "Kidney_DD", "Kidney_LD")]
mcv.xplant <- mcv.xplant[-26, c("Year","Liver", "Liver_DD", "Liver_LD","Kidney", "Kidney_DD", "Kidney_LD")  ]
duke.xplant <- duke.xplant[-26, c("Year","Liver", "Liver_DD", "Liver_LD","Kidney", "Kidney_DD", "Kidney_LD")]
unc.xplant <- unc.xplant[-26, c("Year","Liver", "Liver_DD", "Liver_LD","Kidney", "Kidney_DD", "Kidney_LD") ]
r11.xplant <- r11.xplant[-26, c("Year","Liver", "Liver_DD", "Liver_LD","Kidney", "Kidney_DD", "Kidney_LD") ]
r11.donor <- r11.donor[-26, c("Year","Liver", "Liver_DD", "Liver_LD","Kidney", "Kidney_DD", "Kidney_LD") ]
uva.kidney<-uva.xplant$Kidney
mcv.kidney<-mcv.xplant$Kidney
kid.diff<-ts(uva.kidney-mcv.kidney,1988,2011)
kid.diff<-ts(uva.kidney-mcv.kidney,1988,2012)
t.test(uva.kidney, mcv.kidney,paired=T)
plot(kid.diff)
ts.plot(kid.diff,ylab='UVa-MCV',
main = "Difference in Number of Transplants, UVA-MCV")
bs.mean
bs.mean<-function(x,i)
{
return(mean(x[i]))
}
bs.mean
bs.kid.diff<-boot(kid.diff,bs.mean,R=2000)
kid.diff
bs.kid.diff
plot(bs.kid.diff,index=1)
boot.ci(bs.kid.diff,0.95,type=c('bca','perc'))
bs.mean(kid.diff)
bs.kid.diff<-boot(kid.diff,bs.mean,R=10000)
plot(bs.kid.diff,index=1)
boot.ci(bs.kid.diff,0.95,type=c('bca','perc'))
bs.kid.diff<-boot(kid.diff,bs.mean,R=50000)
plot(bs.kid.diff,index=1)
boot.ci(bs.kid.diff,0.95,type=c('bca','perc'))
uva.kid.lm <- lm(uva.xplant$Kidney ~ r11.donor$Kidney)
uva.kidney<-uva.xplant$Kidney
mcv.kidney<-mcv.xplant$Kidney
duke.kidney<-duke.xplant$Kidney
unc.kidney<-unc.xplant$Kidney
uva.liver<-uva.xplant$Liver
mcv.liver<-mcv.xplant$Liver
duke.liver<-duke.xplant$Liver
unc.liver<-unc.xplant$Liver
mcv.liv.diff <- ts(uva.liver-mcv.liver,1988,2012)
unc.liv.diff <- ts(uva.liver-unc.liver,1988,2012)
duke.liv.diff <- ts(uva.liver-unc.liver,1988,2012)
liv.diff <- data.frame(mcv=mcv.liv.diff, unc=unc.liv.diff, duke=duke.liv.diff)
kid.diff <- data.frame(mcv=mcv.kid.diff, unc=unc.kid.diff, duke=duke.kid.diff)
mcv.kid.diff <- ts(uva.kidney-mcv.kidney,1988,2012)
unc.kid.diff <- ts(uva.kidney-unc.kidney,1988,2012)
duke.kid.diff <- ts(uva.kidney-unc.kidney,1988,2012)
kid.diff <- data.frame(mcv=mcv.kid.diff, unc=unc.kid.diff, duke=duke.kid.diff)
Liv.diff <- data.frame(mcv=mcv.liv.diff, unc=unc.liv.diff, duke=duke.liv.diff)
liv.diff <- stack(Liv.diff)
png("./project/figures/diff_liver.png", width=900, height=900)#, pointsize=30)
par(mfrow=c(3,1), ps=20)
mcv.liv.diff <- ts(uva.liver-mcv.liver,1988,2012)
unc.liv.diff <- ts(uva.liver-unc.liver,1988,2012)
duke.liv.diff <- ts(uva.liver-unc.liver,1988,2012)
liv.diff <- data.frame(mcv=mcv.liv.diff, unc=unc.liv.diff, duke=duke.liv.diff)
ts.plot(mcv.liv.diff,ylab='UVa-MCV',
main = "Difference in Number of Transplants, UVA-MCV")
ts.plot(mcv.liv.diff,ylab='UVa-UNC',
main = "Difference in Number of Transplants, UVA-UNC")
ts.plot(mcv.liv.diff,ylab='UVa-Duke',
main = "Difference in Number of Transplants, UVA-Duke")
par(mfrow=c(1,1), ps=20)
dev.off()
dev.off()
setwd("~/Documents/UVaGrad/Fall2013/SYS6021/Project3/")
png("./project/figures/diff_liver.png", width=900, height=900)#, pointsize=30)
par(mfrow=c(3,1), ps=20)
mcv.liv.diff <- ts(uva.liver-mcv.liver,1988,2012)
unc.liv.diff <- ts(uva.liver-unc.liver,1988,2012)
duke.liv.diff <- ts(uva.liver-unc.liver,1988,2012)
liv.diff <- data.frame(mcv=mcv.liv.diff, unc=unc.liv.diff, duke=duke.liv.diff)
ts.plot(mcv.liv.diff,ylab='UVa-MCV',
main = "Difference in Number of Transplants, UVA-MCV")
ts.plot(mcv.liv.diff,ylab='UVa-UNC',
main = "Difference in Number of Transplants, UVA-UNC")
ts.plot(mcv.liv.diff,ylab='UVa-Duke',
main = "Difference in Number of Transplants, UVA-Duke")
par(mfrow=c(1,1), ps=20)
dev.off()
png("./project/figures/diff_liver.png", width=900, height=900)#, pointsize=30)
par(mfrow=c(3,1), ps=20)
mcv.liv.diff <- ts(uva.liver-mcv.liver,1988,2012)
unc.liv.diff <- ts(uva.liver-unc.liver,1988,2012)
duke.liv.diff <- ts(uva.liver-unc.liver,1988,2012)
liv.diff <- data.frame(mcv=mcv.liv.diff, unc=unc.liv.diff, duke=duke.liv.diff)
ts.plot(mcv.liv.diff,ylab='UVa-MCV',
main = "Difference in Number of Transplants, UVA-MCV")
ts.plot(unc.liv.diff,ylab='UVa-UNC',
main = "Difference in Number of Transplants, UVA-UNC")
ts.plot(duke.liv.diff,ylab='UVa-Duke',
main = "Difference in Number of Transplants, UVA-Duke")
par(mfrow=c(1,1), ps=20)
dev.off()
png("./project/figures/diff_liver.png", width=900, height=900)#, pointsize=30)
par(mfrow=c(3,1), ps=20)
mcv.liv.diff <- ts(uva.liver-mcv.liver,1988,2012)
unc.liv.diff <- ts(uva.liver-unc.liver,1988,2012)
duke.liv.diff <- ts(uva.liver-duke.liver,1988,2012)
liv.diff <- data.frame(mcv=mcv.liv.diff, unc=unc.liv.diff, duke=duke.liv.diff)
ts.plot(mcv.liv.diff,ylab='UVa-MCV',
main = "Difference in Number of Transplants, UVA-MCV")
ts.plot(unc.liv.diff,ylab='UVa-UNC',
main = "Difference in Number of Transplants, UVA-UNC")
ts.plot(duke.liv.diff,ylab='UVa-Duke',
main = "Difference in Number of Transplants, UVA-Duke")
par(mfrow=c(1,1), ps=20)
dev.off()
png("./project/figures/diff_liver.png", width=900, height=900)#, pointsize=30)
par(mfrow=c(3,1), ps=20)
mcv.liv.diff <- ts(uva.liver-mcv.liver,1988,2012)
unc.liv.diff <- ts(uva.liver-unc.liver,1988,2012)
duke.liv.diff <- ts(uva.liver-duke.liver,1988,2012)
liv.diff <- data.frame(mcv=mcv.liv.diff, unc=unc.liv.diff, duke=duke.liv.diff)
ts.plot(mcv.liv.diff,ylab='UVa-MCV',
main = "Difference in Number of Transplants, UVA-MCV")
abline(0,1)
ts.plot(unc.liv.diff,ylab='UVa-UNC',
main = "Difference in Number of Transplants, UVA-UNC")
abline(0,1)
ts.plot(duke.liv.diff,ylab='UVa-Duke',
main = "Difference in Number of Transplants, UVA-Duke")
abline(0,1)
par(mfrow=c(1,1), ps=20)
dev.off()
png("./project/figures/diff_liver.png", width=900, height=900)#, pointsize=30)
par(mfrow=c(3,1), ps=20)
mcv.liv.diff <- ts(uva.liver-mcv.liver,1988,2012)
unc.liv.diff <- ts(uva.liver-unc.liver,1988,2012)
duke.liv.diff <- ts(uva.liver-duke.liver,1988,2012)
liv.diff <- data.frame(mcv=mcv.liv.diff, unc=unc.liv.diff, duke=duke.liv.diff)
ts.plot(mcv.liv.diff,ylab='UVa-MCV',
main = "Difference in Number of Transplants, UVA-MCV")
abline(0,0)
ts.plot(unc.liv.diff,ylab='UVa-UNC',
main = "Difference in Number of Transplants, UVA-UNC")
abline(0,0)
ts.plot(duke.liv.diff,ylab='UVa-Duke',
main = "Difference in Number of Transplants, UVA-Duke")
abline(0,0)
par(mfrow=c(1,1), ps=20)
dev.off()
ts.plot(mcv.liv.diff,ylab='UVa-MCV',
main = "Difference in Number of Transplants, UVA-MCV")
abline(0,0,lty=3)
png("./project/figures/diff_liver.png", width=900, height=900)#, pointsize=30)
par(mfrow=c(3,1), ps=20)
mcv.liv.diff <- ts(uva.liver-mcv.liver,1988,2012)
unc.liv.diff <- ts(uva.liver-unc.liver,1988,2012)
duke.liv.diff <- ts(uva.liver-duke.liver,1988,2012)
liv.diff <- data.frame(mcv=mcv.liv.diff, unc=unc.liv.diff, duke=duke.liv.diff)
ts.plot(mcv.liv.diff,ylab='UVa-MCV',
main = "Difference in Number of Transplants, UVA-MCV")
abline(0,0,lty=3)
ts.plot(unc.liv.diff,ylab='UVa-UNC',
main = "Difference in Number of Transplants, UVA-UNC")
abline(0,0,lty=3)
ts.plot(duke.liv.diff,ylab='UVa-Duke',
main = "Difference in Number of Transplants, UVA-Duke")
abline(0,0,lty=3)
par(mfrow=c(1,1), ps=20)
dev.off()
png("./project/figures/diff_liver.png", width=900, height=900)#, pointsize=30)
par(mfrow=c(3,1), ps=20)
mcv.liv.diff <- ts(uva.liver-mcv.liver,1988,2012)
unc.liv.diff <- ts(uva.liver-unc.liver,1988,2012)
duke.liv.diff <- ts(uva.liver-duke.liver,1988,2012)
liv.diff <- data.frame(mcv=mcv.liv.diff, unc=unc.liv.diff, duke=duke.liv.diff)
ts.plot(mcv.liv.diff,ylab='UVa-MCV',
main = "Difference in Number of Liver Transplants, UVA-MCV")
abline(0,0,lty=3)
ts.plot(unc.liv.diff,ylab='UVa-UNC',
main = "Difference in Number of Liver Transplants, UVA-UNC")
abline(0,0,lty=3)
ts.plot(duke.liv.diff,ylab='UVa-Duke',
main = "Difference in Number of Liver Transplants, UVA-Duke")
abline(0,0,lty=3)
par(mfrow=c(1,1), ps=20)
dev.off()
png("./project/figures/diff_kidney.png", width=900, height=900)#, pointsize=30)
par(mfrow=c(3,1), ps=20)
mcv.kid.diff <- ts(uva.kidney-mcv.kidney,1988,2012)
unc.kid.diff <- ts(uva.kidney-unc.kidney,1988,2012)
duke.kid.diff <- ts(uva.kidney-unc.kidney,1988,2012)
kid.diff <- data.frame(mcv=mcv.kid.diff, unc=unc.kid.diff, duke=duke.kid.diff)
ts.plot(mcv.kid.diff,ylab='UVa-MCV',
main = "Difference in Number of Kidney Transplants, UVA-MCV")
abline(0,0,lty=3)
ts.plot(unc.kid.diff,ylab='UVa-UNC',
main = "Difference in Number of Kidney Transplants, UVA-UNC")
abline(0,0,lty=3)
ts.plot(duke.kid.diff,ylab='UVa-Duke',
main = "Difference in Number of Kidney Transplants, UVA-Duke")
abline(0,0,lty=3)
par(mfrow=c(1,1), ps=20)
dev.off()
t.test(uva.kidney, mcv.kidney,paired=T)
t.test(uva.kidney, duke.kidney,paired=T)
t.test(uva.kidney, unc.kidney,paired=T)
t.test(uva.liver, mcv.liver,paired=T)
t.test(uva.liver, unc.liver,paired=T)
t.test(uva.liver, duke.liver,paired=T)
bs.mean<-function(x,i)
{
return(mean(x[i]))
}
bs.mean(kid.diff)
bs.mcv.liv.diff<-boot(mcv.liv.diff,bs.mean,R=10000)
bs.unc.liv.diff<-boot(unc.liv.diff,bs.mean,R=10000)
bs.duke.liv.diff<-boot(duke.liv.diff,bs.mean,R=10000)
bs.mcv.kid.diff<-boot(mcv.kid.diff,bs.mean,R=10000)
bs.unc.kid.diff<-boot(unc.kid.diff,bs.mean,R=10000)
bs.duke.kid.diff<-boot(duke.kid.diff,bs.mean,R=10000)
bs.mcv.liv.diff
bs.unc.liv.diff
bs.duke.liv.diff
bs.mcv.kid.diff
bs.unc.kid.diff
bs.duke.kid.diff
plot(bs.mcv.liv.diff,index=1)
plot(bs.unc.liv.diff,index=1)
plot(bs.duke.liv.diff,index=1)
plot(bs.mcv.kid.diff,index=1)
plot(bs.unc.kid.diff,index=1)
plot(bs.duke.kid.diff,index=1)
bs.mcv.liv.diff<-boot(mcv.liv.diff,bs.mean,R=50000)
bs.unc.liv.diff<-boot(unc.liv.diff,bs.mean,R=50000)
bs.duke.liv.diff<-boot(duke.liv.diff,bs.mean,R=50000)
bs.mcv.liv.diff
bs.unc.liv.diff
bs.duke.liv.diff
bs.mcv.kid.diff<-boot(mcv.kid.diff,bs.mean,R=50000)
bs.unc.kid.diff<-boot(unc.kid.diff,bs.mean,R=50000)
bs.duke.kid.diff<-boot(duke.kid.diff,bs.mean,R=50000)
bs.mcv.kid.diff
bs.unc.kid.diff
bs.duke.kid.diff
png("./project/figures/boot_liver.png", width=900, height=900)#, pointsize=30)
par(mfrow=c(3,1), ps=20)
plot(bs.mcv.liv.diff,index=1)
plot(bs.unc.liv.diff,index=1)
plot(bs.duke.liv.diff,index=1)
par(mfrow=c(1,1), ps=20)
dev.off()
png("./project/figures/boot_kidney.png", width=900, height=900)#, pointsize=30)
par(mfrow=c(3,1), ps=20)
plot(bs.mcv.kid.diff,index=1)
plot(bs.unc.kid.diff,index=1)
plot(bs.duke.kid.diff,index=1)
par(mfrow=c(1,1), ps=20)
dev.off()
par(mfrow=c(1,1), ps=20)
png("./project/figures/mcv_boot_liver.png", width=900, height=900)#, pointsize=30)
plot(bs.mcv.liv.diff,index=1)
dev.off()
png("./project/figures/unc_boot_liver.png", width=900, height=900)#, pointsize=30)
plot(bs.unc.liv.diff,index=1)
dev.off()
png("./project/figures/duke_boot_liver.png", width=900, height=900)#, pointsize=30)
plot(bs.duke.liv.diff,index=1)
dev.off()
par(mfrow=c(1,1), ps=20)
par(mfrow=c(1,1), ps=20)
png("./project/figures/mcv_boot_kidney.png", width=900, height=900)#, pointsize=30)
plot(bs.mcv.kid.diff,index=1)
dev.off()
png("./project/figures/unc_boot_kidney.png", width=900, height=900)#, pointsize=30)
plot(bs.unc.kid.diff,index=1)
dev.off()
png("./project/figures/duke_boot_kidney.png", width=900, height=900)#, pointsize=30)
plot(bs.duke.kid.diff,index=1)
dev.off()
par(mfrow=c(1,1), ps=20)
par(mfrow=c(1,1), ps=70)
png("./project/figures/mcv_boot_kidney.png", width=900, height=900)#, pointsize=30)
plot(bs.mcv.kid.diff,index=1)
dev.off()
par(mfrow=c(1,1), ps=20)
png("./project/figures/boot_mcv_liver.png", width=900, height=600)#, pointsize=30)
plot(bs.mcv.liv.diff,index=1)
dev.off()
par(mfrow=c(1,1), ps=20)
png("./project/figures/boot_mcv_liver.png", width=900, height=500)#, pointsize=30)
plot(bs.mcv.liv.diff,index=1)
dev.off()
par(mfrow=c(1,1), ps=20)
png("./project/figures/boot_mcv_liver.png", width=500, height=900)#, pointsize=30)
plot(bs.mcv.liv.diff,index=1)
dev.off()
par(mfrow=c(1,1), ps=20)
png("./project/figures/boot_mcv_liver.png", width=600, height=900)#, pointsize=30)
plot(bs.mcv.liv.diff,index=1)
dev.off()
par(mfrow=c(1,1), ps=20)
png("./project/figures/boot_mcv_liver.png", width=700, height=900)#, pointsize=30)
plot(bs.mcv.liv.diff,index=1)
dev.off()
par(mfrow=c(1,1), ps=20)
png("./project/figures/boot_mcv_liver.png", width=700, height=900)#, pointsize=30)
plot(bs.mcv.liv.diff,index=1, main="Bootstrapped Mean Difference UVa and MCV")
dev.off()
par(mfrow=c(1,1), ps=20)
png("./project/figures/boot_mcv_liver.png", width=700, height=900)#, pointsize=30)
plot(bs.mcv.liv.diff,index=1, main="Bootstrapped Mean Difference UVa and MCV")
dev.off()
png("./project/figures/boot_unc_liver.png", width=700, height=900)#, pointsize=30)
plot(bs.unc.liv.diff,index=1)
dev.off()
png("./project/figures/boot_duke_liver.png", width=700, height=900)#, pointsize=30)
plot(bs.duke.liv.diff,index=1)
dev.off()
par(mfrow=c(1,1), ps=20)
par(mfrow=c(1,1), ps=70)
png("./project/figures/boot_mcv_kidney.png", width=700, height=900)#, pointsize=30)
plot(bs.mcv.kid.diff,index=1)
dev.off()
png("./project/figures/boot_unc_kidney.png", width=700, height=900)#, pointsize=30)
plot(bs.unc.kid.diff,index=1)
dev.off()
png("./project/figures/boot_duke_kidney.png", width=700, height=900)#, pointsize=30)
plot(bs.duke.kid.diff,index=1)
dev.off()
par(mfrow=c(1,1), ps=20)
# setwd("~/Google Drive/UVaGrad/6021/RCode")
# Directory <- dir()
# r.code.files <- Directory[grepl("R$",Directory)]
# files.of.interest <- c("")
# r.code.files <- r.code.files[!grepl("Boot1.R",r.code.files)]
# r.code.files <- r.code.files[!grepl("Boot2.R",r.code.files)]
# r.code.files
# r.code.files[1]
# for (i in 1:length(r.code.files)) {
#   print(r.code.files[i])
#   source(r.code.files[i])
# }
setwd("~/Google Drive/UVaGrad/6021/Project3/TransplantData")
r11.donor<-read.table("R11donor.csv", sep = ",", header = T)
us.donor<-read.table("USdonor.csv", sep = ",", header = T)
#r11.donor$Location <- rep("r11", len.xplant)
#us.donor$Location <- rep("us", len.xplant)
#donor <- merge(r11.donor, us.donor, all.x=TRUE, all.y=TRUE)
#donor$Location <- factor(donor$Location)
len.xplant <- 26
r11.xplant <- read.table("R11xplant.csv", sep = ",", header = T)
uva.xplant <- read.table("UVAxplant.csv", sep = ",", header = T)
duke.xplant <- read.table("Dukexplant.csv", sep = ",", header = T)
mcv.xplant <- read.table("MCVxplant.csv", sep = ",", header = T)
unc.xplant <- read.table("UNCxplant.csv", sep = ",", header = T)
us.xplant <- read.table("UStransplant.csv", sep = ",", header = T)
r11.xplant$Location <- rep("r11", len.xplant)
uva.xplant$Location <- rep("uva", len.xplant)
duke.xplant$Location <- rep("duke", len.xplant)
mcv.xplant$Location <- rep("mcv", len.xplant)
unc.xplant$Location <- rep("unc", len.xplant)
us.xplant$Location <- rep("us", len.xplant)
xplant <- merge(r11.xplant, uva.xplant, all.x=TRUE, all.y=TRUE)
xplant <- merge(xplant, duke.xplant, all.x=TRUE, all.y=TRUE)
xplant <- merge(xplant, mcv.xplant, all.x=TRUE, all.y=TRUE)
xplant <- merge(xplant, unc.xplant, all.x=TRUE, all.y=TRUE)
#xplant <- merge(xplant, us.xplant, all.x=TRUE, all.y=TRUE)
xplant$Location <- factor(xplant$Location)
duke.eth <- read.table('DukeEthnic.csv', sep = ',', header = T)
mcv.eth <- read.table('MCVethnic.csv', sep = ',', header = T)
r11.eth <- read.table('R11ethnic.csv', sep = ',', header = T)
uva.eth <- read.table('UVAethnic.csv', sep = ',', header = T)
uva.eth$Location <- rep("uva", len.xplant)
duke.eth$Location <- rep("duke", len.xplant)
mcv.eth$Location <- rep("mcv", len.xplant)
r11.eth$Location <- rep("r11", len.xplant)
eth <- merge(uva.eth, duke.eth, all.x=TRUE, all.y=TRUE)
eth <- merge(eth, mcv.eth, all.x=TRUE, all.y=TRUE)
eth <- merge(eth, r11.eth, all.x=TRUE, all.y=TRUE)
eth$Location <- factor(eth$Location)
setwd("~/Google Drive/UVaGrad/6021/RCode/")
# source("TSbootfunctions.R")
# source("SPM_Panel.R")
# source("Transplant.plots.R")
# source("DemographicFunctions.R")
# source("DemographicFunctions-1.R")
r.code.files <- c("TSbootfunctions.R", "SPM_Panel-1.R", "Transplant.plots.R",
"DemographicFunctions.R", "DemographicFunctions-1.R")
for (i in 1:length(r.code.files)) {
source(r.code.files[i])
}
setwd("~/Documents/UVaGrad/Fall2013/SYS6021/Project3/")
uva.xplant <- uva.xplant[-26, c("Year", "Liver", "Liver_DD", "Liver_LD","Kidney", "Kidney_DD", "Kidney_LD")]
mcv.xplant <- mcv.xplant[-26, c("Year","Liver", "Liver_DD", "Liver_LD","Kidney", "Kidney_DD", "Kidney_LD")  ]
duke.xplant <- duke.xplant[-26, c("Year","Liver", "Liver_DD", "Liver_LD","Kidney", "Kidney_DD", "Kidney_LD")]
unc.xplant <- unc.xplant[-26, c("Year","Liver", "Liver_DD", "Liver_LD","Kidney", "Kidney_DD", "Kidney_LD") ]
r11.xplant <- r11.xplant[-26, c("Year","Liver", "Liver_DD", "Liver_LD","Kidney", "Kidney_DD", "Kidney_LD") ]
r11.donor <- r11.donor[-26, c("Year","Liver", "Liver_DD", "Liver_LD","Kidney", "Kidney_DD", "Kidney_LD") ]
library(boot)
library(forecast)
region.plot(cbind(r11.xplant$Liver[-26], r11.donor$Liver[-26], uva.xplant$Liver[-26], unc.xplant$Liver[-26], mcv.xplant$Liver[-26], duke.xplant$Liver[-26]),Year = seq(1988,2012), title = "Liver Transplants")
center.plot(cbind(uva.xplant$Liver[-26], unc.xplant$Liver[-26], mcv.xplant$Liver[-26], duke.xplant$Liver[-26]), Year = seq(1988,2012), title = "Liver Transplants")
setwd("./TransplantData/")
uva <- read.table("UVAxplant.csv", sep = ",", header = T)
duke <- read.table("Dukexplant.csv", sep = ",", header = T)
mcv <- read.table("MCVxplant.csv", sep = ",", header = T)
unc <- read.table("UNCxplant.csv", sep = ",", header = T)
r11donor <- read.table("R11donor.csv", sep = ",", header = T)
r11xplant <- read.table("R11xplant.csv", sep = ",", header = T)
setwd("..")
t.test(uva$Liver[1:17], uva$Liver[18:26])
wilcox.test(uva$Liver[1:17], uva$Liver[18:26])
uva.Liv <- lm(uva$Liver[-26]~r11donor$Liver[-26])
summary(uva.Liv)
par(mfrow = c(2,2))
plot(uva.Liv)
par(mfrow = c(1,1))
par(mfcol = c(1,2))
acf(uva.Liv$residuals)
pacf(uva.Liv$residuals)
par(mfcol = c(1,1))
library(MASS)
boxcox(uva.Liv)
Roan <- c(rep(0, 17), rep(1, 8))
uva.liv2 <- lm(uva$Liver[-26]~Roan + r11donor$Liver[-26])
uva.liv2 <- lm(uva$Liver[-26]~Roan + r11donor$Liver[-26])
summary(uva.liv2)
par(mfrow = c(2,2))
plot(uva.liv2)
par(mfrow = c(1,1))
par(mfrow = c(1,2))
acf(uva.liv2$resid, main = "ACF for Resid from RS1")
pacf(uva.liv2$resid, main = "PACF for Resid from RS1")
par(mfrow = c(1,1))
uvaliv.ar <- ar(uva.liv2$resid)
uvaliv.ar
plot(uvaliv.ar$aic, type = "h", ylab = "AIC")
uvaliv.ar$aic
uva.liv3 <- lm(uva$Liver[2:25]~Roan[2:25] + r11donor$Liver[2:25]+uva.liv2$resid[1:24])
summary(uva.liv3)
par(mfrow = c(2,2))
plot(uva.liv3)
par(mfrow = c(1,1))
par(mfrow = c(1,2))
acf(uva.liv3$resid, main = "ACF for Resid from RS2")
pacf(uva.liv3$resid, main = "PACF for Resid from RS2")
par(mfrow = c(1,1))
uva.fit <- fitted(uva.liv3)
uva.le <- residuals(uva.liv3)
uva.mod <- model.matrix(uva.liv3)
uva.liv.boot <- RTSB(uva$Liver[2:25], Roan[2:25], uva.fit, uva.le, uva.mod,2000)
uva.liv.boot
plot(uva.liv.boot, index = 2)
boot.ci(uva.liv.boot, index = 2)
hist(uva$Liver, breaks = 20)
rug(uva$Liver)
ldf = data.frame(UVAL = uva$Liver[1:25], R11D = r11donor$Liver[1:25])
uva.liv.glm <- glm(UVAL ~ ., data = ldf, family = poisson)
summary(uva.liv.glm)
uva.liv.null <- glm(UVAL~1, data = ldf, family = poisson)
anova(uva.liv.null, uva.liv.glm, test= "Chi")
sum(resid(uva.liv.glm, type = "pearson")^2/uva.liv.glm$df.residual)
uva.liv.glm2 <- glm(uva$Liver~r11donor$Liver, family = quasipoisson)
summary(uva.liv.glm2)
par(mfrow = c(2,2))
plot(uva.liv.glm2)
par(mfrow = c(1,1))
uva.liv.res <- residuals(uva.liv.glm2, type = "pearson")
par(mfrow = c(1,2))
acf(uva.liv.res)
pacf(uva.liv.res)
par(mfrow = c(1,1))
ldf = data.frame(UVAL = uva$Liver[2:25], R11D = r11donor$Liver[2:25], LUVAL = uva.liv.res[1:24])
uva.liv.glm3 <- glm(UVAL~., data = ldf, family = quasipoisson)
uva.liv.null <- glm(UVAL~1, data = ldf, family = quasipoisson)
anova(uva.liv.null, uva.liv.glm3, test= "Chi")
summary(uva.liv.glm3)
par(mfrow = c(2,2))
plot(uva.liv.glm3)
par(mfrow = c(1,1))
Roan <- c(rep(0, 17), rep(1, 8))
ldf = data.frame(UVAL = uva$Liver[2:25], R11D = r11donor$Liver[2:25], LUVAL = uva.liv.res[1:24], Roan = Roan[2:25])
uva.liv.glm4 <- glm(UVAL~., data = ldf, family = quasipoisson)
summary(uva.liv.glm4)
summary(uva.liv.glm4)
uva.liv.null <- glm(UVAL~1, data = ldf, family = quasipoisson)
anova(uva.liv.null, uva.liv.glm4, test= "Chi")
par(mfrow = c(2,2))
plot(uva.liv.glm4)
par(mfrow = c(1,1))
summary(uva.liv.glm4)
uva.liv.res <- residuals(uva.liv.glm4, type = "pearson")
par(mfrow = c(1,2))
acf(uva.liv.res)
pacf(uva.liv.res)
par(mfrow = c(1,1))
uva.liv.nRoan <- glm(UVAL~., data = ldf[,-4], family = quasipoisson)
anova(uva.liv.nRoan, uva.liv.glm4, test= "Chi")
